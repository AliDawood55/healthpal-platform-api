openapi: 3.0.3
info:
  title: HealthPal â€” Alerts & Guides API
  version: 1.0.0
servers:
  - url: http://localhost:5000
paths:
  /api/alerts:
    get:
      summary: List alerts
      parameters:
        - in: query
          name: severity
          schema: { type: string, enum: [info, warning, critical] }
        - in: query
          name: region
          schema: { type: string }
        - in: query
          name: from
          schema: { type: string, format: date-time }
        - in: query
          name: to
          schema: { type: string, format: date-time }
        - in: query
          name: page
          schema: { type: integer, default: 1 }
        - in: query
          name: limit
          schema: { type: integer, default: 20 }
      responses:
        '200':
          description: Alerts list
          content:
            application/json:
              schema:
                type: array
                items: { $ref: '#/components/schemas/Alert' }
    post:
      summary: Create alert
      parameters:
        - in: header
          name: X-Role
          schema: { type: string }
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/AlertCreate' }
      responses:
        '201': { description: Created }
  /api/alerts/{id}:
    put:
      summary: Update alert
      parameters:
        - in: path
          name: id
          required: true
          schema: { type: integer }
        - in: header
          name: X-Role
          schema: { type: string }
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/AlertUpdate' }
      responses:
        '200': { description: Updated }
    delete:
      summary: Delete alert
      parameters:
        - in: path
          name: id
          required: true
          schema: { type: integer }
        - in: header
          name: X-Role
          schema: { type: string }
      responses:
        '204': { description: Deleted }
  /api/alerts/stream:
    get:
      summary: Alerts SSE stream
      responses:
        '200': { description: Server-Sent Events stream }
  /api/guides:
    get:
      summary: List guides
      parameters:
        - in: query
          name: category
          schema: { type: string, enum: [first_aid, chronic_care, nutrition, maternal, mental_health, general] }
        - in: query
          name: language
          schema: { type: string, enum: [ar, en] }
        - in: query
          name: q
          schema: { type: string }
        - in: query
          name: page
          schema: { type: integer, default: 1 }
        - in: query
          name: limit
          schema: { type: integer, default: 20 }
      responses:
        '200':
          description: Guides list
          content:
            application/json:
              schema:
                type: array
                items: { $ref: '#/components/schemas/Guide' }
    post:
      summary: Create guide
      parameters:
        - in: header
          name: X-Role
          schema: { type: string }
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/GuideCreate' }
      responses:
        '201': { description: Created }
  /api/guides/{id}:
    put:
      summary: Update guide
      parameters:
        - in: path
          name: id
          required: true
          schema: { type: integer }
        - in: header
          name: X-Role
          schema: { type: string }
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/GuideUpdate' }
      responses:
        '200': { description: Updated }
    delete:
      summary: Delete guide
      parameters:
        - in: path
          name: id
          required: true
          schema: { type: integer }
        - in: header
          name: X-Role
          schema: { type: string }
      responses:
        '204': { description: Deleted }
components:
  schemas:
    Alert:
      type: object
      properties:
        id: { type: integer }
        title: { type: string }
        message: { type: string }
        severity: { type: string, enum: [info, warning, critical] }
        region: { type: string }
        created_at: { type: string, format: date-time }
    AlertCreate:
      type: object
      required: [title, message, severity]
      properties:
        title: { type: string }
        message: { type: string }
        severity: { type: string, enum: [info, warning, critical] }
        region: { type: string }
    AlertUpdate:
      type: object
      properties:
        title: { type: string }
        message: { type: string }
        severity: { type: string, enum: [info, warning, critical] }
        region: { type: string }
    Guide:
      type: object
      properties:
        id: { type: integer }
        title: { type: string }
        category: { type: string }
        language: { type: string }
        content: { type: string }
        created_at: { type: string, format: date-time }
        updated_at: { type: string, format: date-time }
    GuideCreate:
      type: object
      required: [title, category, content]
      properties:
        title: { type: string }
        category: { type: string }
        language: { type: string }
        content: { type: string }
    GuideUpdate:
      type: object
      properties:
        title: { type: string }
        category: { type: string }
        language: { type: string }
        content: { type: string }
